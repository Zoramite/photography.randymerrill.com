extends layout

block content
  //- underscore helps us filter and sort our articles
  - var articles = _.chain(contents.articles._.directories).map(function(item) {
  -   // map articles to index pages of subdirectories of 'articles'
  -   console.log(item.index);
  -   return item.index
  - }).compact().sortBy(function(item) { // compact removes any directories w/o an index
  -   // sort them by date
  -   return -item.date
  - }).first(5).value() // and finally take the first 5
  each article in articles
    - var zeroFill = ''
    - var gLen = (article._metadata.gallery ? article._metadata.gallery.toString().length : 0)
    - var pLen = article._metadata.preview.toString().length
    - for(var j = pLen; j < gLen; j++)
      - zeroFill += '0'

    article.post
      .row
        if article.metadata.preview
          .third
            figure.preview
              a(href=article.url)
                img(src=article.url + "images/thumb" + zeroFill + article.metadata.preview + ".jpg")
        .twothird
          h2
            a(href=article.url)= article.title
          .content !{ article.intro }
            if article.hasMore
              p.read-more
               a(href=article.url) Read more...
            p.posted Posted on 
              mixin dateFormat(article.metadata.date) 
              | by 
              mixin author(article.metadata.author)
              | .

  p: a.archives(href="/archive.html") View more in the archives...
